#!/usr/bin/env bash

set -e

function _logger(){
  echo "========== $(date -u '+%Y-%m-%d_%H:%M:%S') $1 =========="
}

_logger "Install Ansible Dependency Packages..."
sudo yum install -y python python-setuptools gcc python-devel libffi-devel openssl-devel

_logger "Install Pip..."
sudo easy_install pip

_logger "Upgrade Setuptools..."
sudo pip install setuptools --upgrade

_logger "Install Ansible..."
sudo pip install ansible

_logger "Downloading playbook..."
curl -fsSL "https://raw.githubusercontent.com/IMOKURI/dotfiles/master/setup.yaml" -o ~/.setup.yaml

_logger "Run Ansible Playbook..."
ansible-playbook ~/.setup.yaml --tags "initialize,deploy"

_logger "Finished!"
